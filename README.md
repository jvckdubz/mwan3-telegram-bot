# MWAN3 Telegram Bot

Простой Telegram-бот для роутера с OpenWRT, который отслеживает переключение между основным и резервным интернет-каналом через `mwan3` и отправляет уведомления в Telegram.

## Возможности

- Уведомляет в Telegram при переключении каналов (основной/резервный)
- Собирает статистику по количеству переключений и времени на резервном канале
- Отвечает на команду `/статус` — показывает статистику за сегодня и текущий месяц
- Автоматически сбрасывает статистику:
  - Ежедневно очищает старые данные
  - В первый день месяца очищает весь файл статистики
- Очищает лог-файл `bot.log` ежедневно
- Хранит состояние и статистику в файлах (`state.json`, `stats.json`)

## Установка

1. Клонируйте репозиторий на роутер или сервер:

```
git clone https://github.com/your_username/mwan3-telegram-bot.git
```

2. Установите зависимости (только `requests`, если нет):

```
pip3 install requests
```

3. В `bot.py` замените `ВАШ_ТОКЕН` и `ВАШ_CHAT_ID` на ваши значения от Telegram-бота.

4. Запустите бота:

```
python3 bot.py
```

## Интеграция с mwan3

Добавьте в `/etc/mwan3.user` или в конфигурацию:

```sh
/path/to/event-hook.sh "$ACTION"
```

Или вызовите напрямую:

```sh
curl "http://localhost:8081/?state=main"
```

`event-hook.sh` — это простой скрипт, который отправляет новое состояние в бот.

## Файлы

- `bot.py` — основной код бота
- `event-hook.sh` — вызывается системой при переключении
- `state.json` — текущее состояние (создаётся автоматически)
- `stats.json` — статистика за дни и месяцы (создаётся автоматически)
- `bot.log` — лог-файл (опционально)

## Лицензия

MIT
